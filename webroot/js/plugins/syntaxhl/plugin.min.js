tinymce.PluginManager.add("syntaxhl",function(e,t){function n(e){return function(){e()}}function r(){var t={},n={},r,i=e.selection,s=e.dom,o,u,a;var f,l,c,h;o=i.getNode();u=s.getParent(o,"pre");t.code=a=u?u.innerText||u.textContent:i.getContent({format:"text"});t.class=u?s.getAttrib(u,"class"):"";n=t.class.split(";").filter(function(e){return e});for(var p=0;p<n.length;p++){r=n[p].split(":");if(r[0]==="brush"){t.brush=r[1]}else if(r[0]==="fontsize"){t.fontsize=r[1]}else if(r[0]==="first-line"){t.firstline=r[1]}else if(r[0]==="gutter"){t.firstline=r[1]}else if(r[0]==="light"){t.firstline=r[1]}else if(r[0]==="collapse"){t.firstline=r[1]}else if(r[0]==="highlight"){t.firstline=r[1]}}f=e.windowManager.open({width:800,height:500,title:"Insert/edit code",data:t,body:[{type:"listbox",name:"brush",label:"Language",values:[{text:"Bash/Shell",value:"bash"},{text:"CSS",value:"css"},{text:"Jscript",value:"jscript"},{text:"PHP",value:"php"},{text:"SQL",value:"sql"}]},{type:"textbox",name:"firstline",label:"First Line",value:"1"},{type:"textbox",name:"fontsize",label:"Font Size",value:"100%"},{type:"textbox",name:"code",label:"Code",multiline:true,style:"height:200px;"},{type:"checkbox",name:"gutter",label:"No Gutter"},{type:"checkbox",name:"light",label:"Light"},{type:"checkbox",name:"collapse",label:"Collapse"},{type:"textbox",name:"highlight",label:"Highlight"}],onSubmit:function(t){if(t.data.code==""){return false}var n="";if(t.data.brush!=""){n+="brush:"+t.data.brush+";"}if(t.data.gutter){n+="gutter:false;"}if(t.data.light){n+="light:true;"}if(t.data.collapse){n+="collapse:true;"}if(t.data.fontsize!=""){var r=parseInt(t.data.fontsize);n+="fontsize:"+r+";"}if(t.data.firstline!=""){var o=parseInt(t.data.firstline);n+="first-line:"+o+";"}if(t.data.highlight!=""){n+="highlight:["+t.data.highlight+"];"}var a='<pre class="';a+=n+'">';a+=e.dom.encode(t.data.code);a+="</pre> ";if(u){e.focus();u.innerHTML=e.dom.encode(t.data.code);s.setAttribs(u,{"class":n});i.select(u)}else{e.insertContent(a)}}})}e.on("init",function(){e.dom.loadCSS(t+"/css/preelementfix.css")});e.addButton("syntaxhl",{icon:"code",tooltip:"Insert/edit code",onclick:n(r),stateSelector:"pre[class]"})})